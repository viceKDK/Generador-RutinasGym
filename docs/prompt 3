import React, { useState, useEffect } from 'react';
import { Card } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Progress } from '@/components/ui/progress';
import { Badge } from '@/components/ui/badge';
import { User, Calendar, CheckCircle2, AlertCircle, Clock } from 'lucide-react';
import { cn } from '@/lib/utils';

export enum Gender {
  MALE = 'male',
  FEMALE = 'female',
  OTHER = 'other'
}

export interface ClientData {
  selectedGender: Gender | null;
  clientAge: number | null;
  trainingDays: number;
}

export interface ClientInfoCardProps {
  data: ClientData;
  onChange: (data: ClientData) => void;
  className?: string;
}

const GENDER_OPTIONS = [
  { value: Gender.MALE, label: 'Hombre', icon: '👨' },
  { value: Gender.FEMALE, label: 'Mujer', icon: '👩' },
  { value: Gender.OTHER, label: 'Otro', icon: '👤' }
];

const TRAINING_DAYS_OPTIONS = [
  { value: 1, label: '1 día', description: 'Principiante' },
  { value: 2, label: '2 días', description: 'Básico' },
  { value: 3, label: '3 días', description: 'Intermedio' },
  { value: 4, label: '4 días', description: 'Avanzado' },
  { value: 5, label: '5 días', description: 'Intensivo' },
  { value: 6, label: '6 días', description: 'Atlético' },
  { value: 7, label: '7 días', description: 'Profesional' }
];

export const ClientInfoCard: React.FC<ClientInfoCardProps> = ({
  data,
  onChange,
  className
}) => {
  const [ageInput, setAgeInput] = useState<string>(data.clientAge?.toString() || '');
  const [ageError, setAgeError] = useState<string>('');

  // Validation and completion calculation
  const validateAge = (age: number | null): boolean => {
    if (age === null) return false;
    return age >= 16 && age <= 100;
  };

  const isGenderValid = data.selectedGender !== null;
  const isAgeValid = validateAge(data.clientAge);
  const isTrainingDaysValid = data.trainingDays >= 1 && data.trainingDays <= 7;

  const completedFields = [isGenderValid, isAgeValid, isTrainingDaysValid].filter(Boolean).length;
  const completionPercentage = (completedFields / 3) * 100;
  const isValid = completedFields === 3;

  // Handle age input changes
  useEffect(() => {
    const ageValue = parseInt(ageInput);

    if (ageInput === '') {
      setAgeError('');
      onChange({ ...data, clientAge: null });
      return;
    }

    if (isNaN(ageValue)) {
      setAgeError('Por favor ingresa un número válido');
      return;
    }

    if (ageValue < 16) {
      setAgeError('La edad mínima es 16 años');
      return;
    }

    if (ageValue > 100) {
      setAgeError('La edad máxima es 100 años');
      return;
    }

    setAgeError('');
    onChange({ ...data, clientAge: ageValue });
  }, [ageInput]);

  const getCompletionStatus = () => {
    if (completionPercentage === 100) {
      return { color: 'text-success', bgColor: 'bg-success/10', icon: CheckCircle2, text: 'Completo' };
    } else if (completionPercentage > 0) {
      return { color: 'text-warning', bgColor: 'bg-warning/10', icon: Clock, text: 'En progreso' };
    } else {
      return { color: 'text-muted-foreground', bgColor: 'bg-muted', icon: AlertCircle, text: 'Pendiente' };
    }
  };

  const status = getCompletionStatus();
  const StatusIcon = status.icon;

  return (
    <Card className={cn(
      "relative overflow-hidden bg-card/50 backdrop-blur-sm border-2",
      isValid ? "border-success/30 shadow-success" : "border-border",
      className
    )}>
      {/* Completion glow effect */}
      {isValid && (
        <div className="absolute inset-0 bg-gradient-success opacity-5 animate-pulse-glow pointer-events-none" />
      )}

      <div className="p-6 space-y-6">
        {/* Header */}
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="p-2 bg-gradient-primary rounded-lg">
              <User className="w-5 h-5 text-primary-foreground" />
            </div>
            <div>
              <h3 className="text-xl font-semibold text-foreground">
                Datos del Cliente
              </h3>
              <p className="text-sm text-muted-foreground">
                Información básica para personalizar la rutina
              </p>
            </div>
          </div>

          <Badge
            variant="outline"
            className={cn(
              "flex items-center gap-2 px-3 py-1",
              status.color,
              status.bgColor
            )}
          >
            <StatusIcon className="w-4 h-4" />
            {status.text}
          </Badge>
        </div>

        {/* Progress Bar */}
        <div className="space-y-2">
          <div className="flex justify-between items-center">
            <Label className="text-sm text-muted-foreground">Progreso de completación</Label>
            <span className="text-sm font-medium text-foreground">{Math.round(completionPercentage)}%</span>
          </div>
          <Progress
            value={completionPercentage}
            className="h-2"
            style={{
              background: 'hsl(var(--muted))',
            }}
          />
        </div>

        {/* Gender Selection */}
        <div className="space-y-3">
          <Label className="text-base font-medium flex items-center gap-2">
            <span className="text-2xl">👥</span>
            Género
            {!isGenderValid && <span className="text-destructive text-sm">(Requerido)</span>}
          </Label>

          <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
            {GENDER_OPTIONS.map((option) => (
              <Button
                key={option.value}
                variant={data.selectedGender === option.value ? "default" : "outline"}
                size="lg"
                className={cn(
                  "h-14 justify-start gap-3 text-base",
                  data.selectedGender === option.value
                    ? "bg-gradient-primary text-primary-foreground shadow-primary"
                    : "hover:bg-accent hover:text-accent-foreground"
                )}
                onClick={() => onChange({ ...data, selectedGender: option.value })}
              >
                <span className="text-xl">{option.icon}</span>
                {option.label}
              </Button>
            ))}
          </div>
        </div>

        {/* Age Input */}
        <div className="space-y-3">
          <Label className="text-base font-medium flex items-center gap-2">
            <span className="text-2xl">🎂</span>
            Edad del Cliente
            {!isAgeValid && data.clientAge !== null && <span className="text-destructive text-sm">(16-100 años)</span>}
          </Label>

          <div className="space-y-2">
            <Input
              type="number"
              placeholder="Ejemplo: 35"
              value={ageInput}
              onChange={(e) => setAgeInput(e.target.value)}
              className={cn(
                "h-12 text-base",
                ageError ? "border-destructive focus-visible:ring-destructive" : "",
                isAgeValid ? "border-success focus-visible:ring-success" : ""
              )}
              min="16"
              max="100"
            />
            {ageError && (
              <p className="text-sm text-destructive flex items-center gap-2">
                <AlertCircle className="w-4 h-4" />
                {ageError}
              </p>
            )}
          </div>
        </div>

        {/* Training Days Selection */}
        <div className="space-y-4">
          <Label className="text-base font-medium flex items-center gap-2">
            <Calendar className="w-5 h-5" />
            Días de Entrenamiento por Semana
          </Label>

          <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
            {TRAINING_DAYS_OPTIONS.map((option) => (
              <Button
                key={option.value}
                variant={data.trainingDays === option.value ? "default" : "outline"}
                size="lg"
                className={cn(
                  "h-16 flex-col gap-1 text-center",
                  data.trainingDays === option.value
                    ? "bg-gradient-secondary text-secondary-foreground shadow-primary"
                    : "hover:bg-accent hover:text-accent-foreground"
                )}
                onClick={() => onChange({ ...data, trainingDays: option.value })}
              >
                <span className="font-semibold">{option.label}</span>
                <span className="text-xs opacity-80">{option.description}</span>
              </Button>
            ))}
          </div>
        </div>

        {/* Summary */}
        {isValid && (
          <div className="p-4 bg-success/10 border border-success/20 rounded-lg animate-fade-in-up">
            <div className="flex items-center gap-2 mb-2">
              <CheckCircle2 className="w-5 h-5 text-success" />
              <h4 className="font-semibold text-success">Información Completa</h4>
            </div>
            <p className="text-sm text-muted-foreground">
              Cliente {data.selectedGender === Gender.MALE ? 'masculino' : data.selectedGender === Gender.FEMALE ? 'femenino' : ''}
              de {data.clientAge} años, entrenando {data.trainingDays} {data.trainingDays === 1 ? 'día' : 'días'} por semana.
            </p>
          </div>
        )}
      </div>
    </Card>
  );
};
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here.
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Fitness-themed color palette */
    --background: 240 6% 10%;
    --foreground: 0 0% 98%;

    --card: 240 4% 16%;
    --card-foreground: 0 0% 98%;

    --popover: 240 4% 16%;
    --popover-foreground: 0 0% 98%;

    /* Primary: Electric Blue for gym energy */
    --primary: 210 100% 56%;
    --primary-foreground: 0 0% 98%;
    --primary-glow: 210 100% 70%;

    /* Secondary: Gym Orange for accents */
    --secondary: 25 95% 53%;
    --secondary-foreground: 0 0% 98%;

    /* Success: Vibrant Green */
    --success: 120 84% 50%;
    --success-foreground: 0 0% 98%;
    --success-glow: 120 84% 65%;

    /* Warning: Energetic Orange */
    --warning: 35 91% 62%;
    --warning-foreground: 0 0% 98%;

    /* Muted tones */
    --muted: 240 4% 20%;
    --muted-foreground: 240 5% 65%;

    --accent: 240 4% 20%;
    --accent-foreground: 240 5% 85%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;

    --border: 240 4% 25%;
    --input: 240 4% 25%;
    --ring: 210 100% 56%;

    /* Fitness gradients */
    --gradient-primary: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary-glow)));
    --gradient-success: linear-gradient(135deg, hsl(var(--success)), hsl(var(--success-glow)));
    --gradient-secondary: linear-gradient(135deg, hsl(var(--secondary)), hsl(var(--warning)));
    --gradient-bg: linear-gradient(135deg, hsl(240 6% 10%), hsl(240 4% 16%));

    /* Shadows with glow effects */
    --shadow-primary: 0 10px 30px -10px hsl(var(--primary) / 0.3);
    --shadow-success: 0 10px 30px -10px hsl(var(--success) / 0.3);
    --shadow-glow: 0 0 40px hsl(var(--primary-glow) / 0.4);

    /* Animation timing */
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);

    --radius: 0.5rem;

    --sidebar-background: 0 0% 98%;

    --sidebar-foreground: 240 5.3% 26.1%;

    --sidebar-primary: 240 5.9% 10%;

    --sidebar-primary-foreground: 0 0% 98%;

    --sidebar-accent: 240 4.8% 95.9%;

    --sidebar-accent-foreground: 240 5.9% 10%;

    --sidebar-border: 220 13% 91%;

    --sidebar-ring: 217.2 91.2% 59.8%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;

    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;

    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;

    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;

    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;

    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
  }
}
import { Toaster } from "@/components/ui/toaster";
import { Toaster as Sonner } from "@/components/ui/sonner";
import { TooltipProvider } from "@/components/ui/tooltip";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { BrowserRouter, Routes, Route } from "react-router-dom";
import Index from "./pages/Index";
import NotFound from "./pages/NotFound";

const queryClient = new QueryClient();

const App = () => (
  <QueryClientProvider client={queryClient}>
    <TooltipProvider>
      <Toaster />
      <Sonner />
      <BrowserRouter>
        <Routes>
          <Route path="/" element={<Index />} />
          {/* ADD ALL CUSTOM ROUTES ABOVE THE CATCH-ALL "*" ROUTE */}
          <Route path="*" element={<NotFound />} />
        </Routes>
      </BrowserRouter>
    </TooltipProvider>
  </QueryClientProvider>
);

export default App;
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
import React, { useState, useEffect } from 'react';
import { ProgressIndicator, ProgressState } from '@/components/ProgressIndicator';
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';
import { Dumbbell, Play, RotateCcw } from 'lucide-react';

// Simulated progress states with Spanish messages
const progressSteps = [
  {
    state: 'indeterminate' as ProgressState,
    message: 'Iniciando generación de rutina...',
    subMessage: 'Preparando el sistema de IA',
    duration: 2000,
    aiMode: 'local' as const,
  },
  {
    state: 'determinate' as ProgressState,
    message: 'Procesando con IA Local (Ollama)...',
    subMessage: 'Analizando perfil del cliente y objetivos',
    duration: 4000,
    progress: [0, 25, 50, 80],
    estimatedTime: 15,
    aiMode: 'local' as const,
  },
  {
    state: 'determinate' as ProgressState,
    message: 'Seleccionando ejercicios personalizados...',
    subMessage: 'Adaptando rutina según experiencia y equipamiento',
    duration: 3000,
    progress: [80, 90, 95],
    estimatedTime: 8,
    aiMode: 'local' as const,
  },
  {
    state: 'determinate' as ProgressState,
    message: 'Optimizando rutina para cliente...',
    subMessage: 'Ajustando volumen, intensidad y progresión',
    duration: 2000,
    progress: [95, 98, 100],
    estimatedTime: 3,
    aiMode: 'local' as const,
  },
  {
    state: 'success' as ProgressState,
    message: '¡Rutina generada exitosamente!',
    subMessage: 'Rutina personalizada lista para implementar',
    duration: 3000,
    aiMode: 'local' as const,
  },
];

const errorState = {
  state: 'error' as ProgressState,
  message: 'Error: IA no disponible',
  subMessage: 'Cambiando automáticamente a modo básico...',
  aiMode: 'basic' as const,
};

export default function Demo() {
  const [currentStep, setCurrentStep] = useState(-1);
  const [currentProgress, setCurrentProgress] = useState(0);
  const [timeRemaining, setTimeRemaining] = useState(0);
  const [isRunning, setIsRunning] = useState(false);
  const [showError, setShowError] = useState(false);

  const startDemo = () => {
    setCurrentStep(0);
    setCurrentProgress(0);
    setTimeRemaining(0);
    setIsRunning(true);
    setShowError(false);
  };

  const startErrorDemo = () => {
    setCurrentStep(-1);
    setCurrentProgress(0);
    setTimeRemaining(0);
    setIsRunning(true);
    setShowError(true);
  };

  const resetDemo = () => {
    setCurrentStep(-1);
    setCurrentProgress(0);
    setTimeRemaining(0);
    setIsRunning(false);
    setShowError(false);
  };

  useEffect(() => {
    if (!isRunning) return;

    if (showError) {
      const timer = setTimeout(() => {
        setShowError(false);
        setIsRunning(false);
      }, 3000);
      return () => clearTimeout(timer);
    }

    if (currentStep >= 0 && currentStep < progressSteps.length) {
      const step = progressSteps[currentStep];
      const startTime = Date.now();

      const updateProgress = () => {
        const elapsed = Date.now() - startTime;
        const remaining = Math.max(0, Math.ceil((step.duration - elapsed) / 1000));
        setTimeRemaining(remaining);

        if (step.progress) {
          const progressIndex = Math.min(
            Math.floor((elapsed / step.duration) * step.progress.length),
            step.progress.length - 1
          );
          setCurrentProgress(step.progress[progressIndex]);
        }

        if (elapsed >= step.duration) {
          if (currentStep < progressSteps.length - 1) {
            setCurrentStep(currentStep + 1);
          } else {
            setTimeout(() => {
              setIsRunning(false);
            }, 2000);
          }
        } else {
          requestAnimationFrame(updateProgress);
        }
      };

      updateProgress();
    }
  }, [currentStep, isRunning, showError]);

  const getCurrentState = () => {
    if (showError) return errorState;
    if (currentStep >= 0 && currentStep < progressSteps.length) {
      return {
        ...progressSteps[currentStep],
        progress: currentProgress,
        estimatedTime: timeRemaining,
      };
    }
    return null;
  };

  const currentState = getCurrentState();

  return (
    <div className="min-h-screen bg-gradient-bg">
      <div className="container mx-auto px-4 py-12">
        {/* Header */}
        <div className="text-center mb-12">
          <div className="flex items-center justify-center gap-3 mb-4">
            <div className="p-3 bg-gradient-primary rounded-xl shadow-primary">
              <Dumbbell className="w-8 h-8 text-primary-foreground" />
            </div>
            <h1 className="text-4xl font-bold bg-gradient-primary bg-clip-text text-transparent">
              GymRoutine Generator
            </h1>
          </div>
          <p className="text-xl text-muted-foreground max-w-2xl mx-auto">
            Generador de rutinas de gimnasio con inteligencia artificial.
            Observa el progreso en tiempo real de la generación de rutinas personalizadas.
          </p>
        </div>

        {/* Demo Controls */}
        <div className="flex justify-center gap-4 mb-8">
          <Button
            onClick={startDemo}
            disabled={isRunning}
            className="bg-gradient-primary hover:shadow-primary shadow-lg"
            size="lg"
          >
            <Play className="w-5 h-5 mr-2" />
            Iniciar Demo Exitoso
          </Button>

          <Button
            onClick={startErrorDemo}
            disabled={isRunning}
            variant="destructive"
            size="lg"
          >
            <Play className="w-5 h-5 mr-2" />
            Demo de Error
          </Button>

          <Button
            onClick={resetDemo}
            variant="outline"
            size="lg"
            className="hover:bg-accent"
          >
            <RotateCcw className="w-5 h-5 mr-2" />
            Reiniciar
          </Button>
        </div>

        {/* Progress Indicator */}
        <div className="max-w-2xl mx-auto mb-12">
        <ProgressIndicator
          state={currentState ? currentState.state : 'hidden'}
          progressValue={currentState && 'progress' in currentState ? currentState.progress : 0}
          statusMessage={currentState?.message || ''}
          subMessage={currentState?.subMessage}
          estimatedTimeRemaining={currentState && 'estimatedTime' in currentState ? currentState.estimatedTime : 0}
          showCancelButton={isRunning && !showError}
          aiMode={currentState?.aiMode}
          onCancel={resetDemo}
          onRetry={startDemo}
        />
        </div>

        {/* Features Info */}
        <div className="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
          <Card className="p-6 bg-card/50 backdrop-blur-sm border-primary/20">
            <div className="text-center">
              <div className="w-12 h-12 bg-gradient-primary rounded-lg mx-auto mb-4 flex items-center justify-center">
                <Dumbbell className="w-6 h-6 text-primary-foreground" />
              </div>
              <h3 className="text-lg font-semibold mb-2">Rutinas Personalizadas</h3>
              <p className="text-muted-foreground text-sm">
                Generación inteligente basada en objetivos, experiencia y equipamiento disponible.
              </p>
            </div>
          </Card>

          <Card className="p-6 bg-card/50 backdrop-blur-sm border-success/20">
            <div className="text-center">
              <div className="w-12 h-12 bg-gradient-success rounded-lg mx-auto mb-4 flex items-center justify-center">
                <Play className="w-6 h-6 text-success-foreground" />
              </div>
              <h3 className="text-lg font-semibold mb-2">Progreso en Tiempo Real</h3>
              <p className="text-muted-foreground text-sm">
                Visualización clara del estado de generación con estimaciones de tiempo precisas.
              </p>
            </div>
          </Card>

          <Card className="p-6 bg-card/50 backdrop-blur-sm border-secondary/20">
            <div className="text-center">
              <div className="w-12 h-12 bg-gradient-secondary rounded-lg mx-auto mb-4 flex items-center justify-center">
                <RotateCcw className="w-6 h-6 text-secondary-foreground" />
              </div>
              <h3 className="text-lg font-semibold mb-2">Manejo de Errores</h3>
              <p className="text-muted-foreground text-sm">
                Fallback automático a modo básico cuando la IA local no está disponible.
              </p>
            </div>
          </Card>
        </div>
      </div>
    </div>
  );
}
import ClientDemo from './ClientDemo';

const Index = () => {
  return <ClientDemo />;
};

export default Index;
import { useLocation } from "react-router-dom";
import { useEffect } from "react";

const NotFound = () => {
  const location = useLocation();

  useEffect(() => {
    console.error("404 Error: User attempted to access non-existent route:", location.pathname);
  }, [location.pathname]);

  return (
    <div className="flex min-h-screen items-center justify-center bg-gray-100">
      <div className="text-center">
        <h1 className="mb-4 text-4xl font-bold">404</h1>
        <p className="mb-4 text-xl text-gray-600">Oops! Page not found</p>
        <a href="/" className="text-blue-500 underline hover:text-blue-700">
          Return to Home
        </a>
      </div>
    </div>
  );
};

export default NotFound;
import React, { useState } from 'react';
import { ClientInfoCard, ClientData, Gender } from '@/components/ClientInfoCard';
import { ProgressIndicator } from '@/components/ProgressIndicator';
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { ArrowRight, Users, Zap, Target, RotateCcw } from 'lucide-react';
import { cn } from '@/lib/utils';

export default function ClientDemo() {
  const [clientData, setClientData] = useState<ClientData>({
    selectedGender: null,
    clientAge: null,
    trainingDays: 3
  });

  const [showProgress, setShowProgress] = useState(false);

  const isDataComplete = () => {
    return clientData.selectedGender !== null &&
           clientData.clientAge !== null &&
           clientData.clientAge >= 16 &&
           clientData.clientAge <= 100 &&
           clientData.trainingDays >= 1 &&
           clientData.trainingDays <= 7;
  };

  const generateRoutine = () => {
    if (isDataComplete()) {
      setShowProgress(true);
      // Auto-hide progress after demo
      setTimeout(() => setShowProgress(false), 8000);
    }
  };

  const resetForm = () => {
    setClientData({
      selectedGender: null,
      clientAge: null,
      trainingDays: 3
    });
    setShowProgress(false);
  };

  const getPersonalizedMessage = () => {
    if (!isDataComplete()) return null;

    const genderText = clientData.selectedGender === Gender.MALE ? 'hombre' :
                      clientData.selectedGender === Gender.FEMALE ? 'mujer' : 'persona';

    const levelText = clientData.trainingDays <= 2 ? 'principiante' :
                     clientData.trainingDays <= 4 ? 'intermedio' : 'avanzado';

    return `Rutina personalizada para ${genderText} de ${clientData.clientAge} años, nivel ${levelText}`;
  };

  return (
    <div className="min-h-screen bg-gradient-bg">
      <div className="container mx-auto px-4 py-12">
        {/* Header */}
        <div className="text-center mb-12">
          <div className="flex items-center justify-center gap-3 mb-4">
            <div className="p-3 bg-gradient-primary rounded-xl shadow-primary">
              <Users className="w-8 h-8 text-primary-foreground" />
            </div>
            <h1 className="text-4xl font-bold bg-gradient-primary bg-clip-text text-transparent">
              Datos del Cliente
            </h1>
          </div>
          <p className="text-xl text-muted-foreground max-w-2xl mx-auto">
            Recopila información esencial del cliente con validación en tiempo real
            y retroalimentación visual clara para generar rutinas personalizadas.
          </p>
        </div>

        <div className="max-w-4xl mx-auto space-y-8">
          {/* Main Client Info Card */}
          <ClientInfoCard
            data={clientData}
            onChange={setClientData}
            className="animate-fade-in-up"
          />

          {/* Personalized Message */}
          {isDataComplete() && (
            <Card className="p-6 bg-primary/5 border-primary/20 animate-fade-in-up">
              <div className="flex items-center gap-3 mb-3">
                <Target className="w-6 h-6 text-primary" />
                <h3 className="text-lg font-semibold text-foreground">Rutina Recomendada</h3>
              </div>
              <p className="text-muted-foreground mb-4">
                {getPersonalizedMessage()}
              </p>
              <div className="flex flex-wrap gap-2">
                <Badge variant="outline" className="bg-success/10 text-success border-success/20">
                  ✓ Información completa
                </Badge>
                <Badge variant="outline" className="bg-primary/10 text-primary border-primary/20">
                  🎯 Personalización activa
                </Badge>
                <Badge variant="outline" className="bg-secondary/10 text-secondary border-secondary/20">
                  ⚡ Listo para generar
                </Badge>
              </div>
            </Card>
          )}

          {/* Action Buttons */}
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <Button
              onClick={generateRoutine}
              disabled={!isDataComplete() || showProgress}
              size="lg"
              className={cn(
                "bg-gradient-primary hover:shadow-primary shadow-lg transition-all duration-300",
                isDataComplete() && "animate-pulse-glow"
              )}
            >
              <Zap className="w-5 h-5 mr-2" />
              Generar Rutina Personalizada
              <ArrowRight className="w-5 h-5 ml-2" />
            </Button>

            <Button
              onClick={resetForm}
              variant="outline"
              size="lg"
              className="hover:bg-accent"
            >
              <RotateCcw className="w-5 h-5 mr-2" />
              Limpiar Formulario
            </Button>
          </div>

          {/* Progress Indicator */}
          {showProgress && (
            <div className="animate-fade-in-up">
              <ProgressIndicator
                state="indeterminate"
                statusMessage="Generando rutina personalizada..."
                subMessage={`Creando rutina para ${clientData.selectedGender === Gender.MALE ? 'hombre' : clientData.selectedGender === Gender.FEMALE ? 'mujer' : 'cliente'} de ${clientData.clientAge} años`}
                aiMode="local"
                showCancelButton={true}
                onCancel={() => setShowProgress(false)}
              />
            </div>
          )}

          {/* Debug Info */}
          <Card className="p-6 bg-muted/20 border-muted">
            <h3 className="text-lg font-semibold mb-4 text-foreground">Estado de Validación</h3>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div className="space-y-2">
                <h4 className="font-medium text-foreground">Género</h4>
                <Badge variant={clientData.selectedGender ? "default" : "destructive"}>
                  {clientData.selectedGender ? "✓ Seleccionado" : "✗ Requerido"}
                </Badge>
                <p className="text-sm text-muted-foreground">
                  {clientData.selectedGender || "No seleccionado"}
                </p>
              </div>

              <div className="space-y-2">
                <h4 className="font-medium text-foreground">Edad</h4>
                <Badge variant={
                  clientData.clientAge && clientData.clientAge >= 16 && clientData.clientAge <= 100
                    ? "default" : "destructive"
                }>
                  {clientData.clientAge && clientData.clientAge >= 16 && clientData.clientAge <= 100
                    ? "✓ Válida" : "✗ Inválida"
                  }
                </Badge>
                <p className="text-sm text-muted-foreground">
                  {clientData.clientAge ? `${clientData.clientAge} años` : "No ingresada"}
                </p>
              </div>

              <div className="space-y-2">
                <h4 className="font-medium text-foreground">Días de Entrenamiento</h4>
                <Badge variant="default">✓ Válido</Badge>
                <p className="text-sm text-muted-foreground">
                  {clientData.trainingDays} {clientData.trainingDays === 1 ? 'día' : 'días'} por semana
                </p>
              </div>
            </div>

            <div className="mt-4 pt-4 border-t border-border">
              <p className="text-sm text-muted-foreground">
                <strong>Estado general:</strong> {isDataComplete() ? "✅ Completo y válido" : "⚠️ Incompleto o inválido"}
              </p>
            </div>
          </Card>
        </div>
      </div>
    </div>
  );
}
import React, { useEffect, useState } from 'react';
import { CheckCircle2, XCircle, AlertCircle, Loader2, X, Brain, Zap } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { cn } from '@/lib/utils';

export type ProgressState = 'hidden' | 'indeterminate' | 'determinate' | 'success' | 'error';

export interface ProgressIndicatorProps {
  state: ProgressState;
  progressValue?: number; // 0-100 for determinate progress
  statusMessage: string;
  subMessage?: string;
  estimatedTimeRemaining?: number; // in seconds
  showCancelButton?: boolean;
  aiMode?: 'local' | 'basic' | null;
  onCancel?: () => void;
  onRetry?: () => void;
  className?: string;
}

const formatTime = (seconds: number): string => {
  if (seconds < 60) return `${seconds}s`;
  const minutes = Math.floor(seconds / 60);
  const remainingSeconds = seconds % 60;
  return `${minutes}m ${remainingSeconds}s`;
};

export const ProgressIndicator: React.FC<ProgressIndicatorProps> = ({
  state,
  progressValue = 0,
  statusMessage,
  subMessage,
  estimatedTimeRemaining,
  showCancelButton = false,
  aiMode,
  onCancel,
  onRetry,
  className,
}) => {
  const [displayProgress, setDisplayProgress] = useState(0);

  // Smooth progress animation
  useEffect(() => {
    if (state === 'determinate' && progressValue !== displayProgress) {
      const timer = setTimeout(() => {
        const diff = progressValue - displayProgress;
        const step = Math.sign(diff) * Math.min(Math.abs(diff), 2);
        setDisplayProgress(prev => prev + step);
      }, 50);
      return () => clearTimeout(timer);
    }
  }, [progressValue, displayProgress, state]);

  if (state === 'hidden') return null;

  const getStateIcon = () => {
    switch (state) {
      case 'success':
        return <CheckCircle2 className="w-6 h-6 text-success animate-check-bounce" />;
      case 'error':
        return <XCircle className="w-6 h-6 text-destructive" />;
      case 'indeterminate':
      case 'determinate':
        return <Loader2 className="w-6 h-6 text-primary animate-spin" />;
      default:
        return null;
    }
  };

  const getAiModeIndicator = () => {
    if (!aiMode) return null;
    return (
      <div className={cn(
        "flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium",
        aiMode === 'local'
          ? "bg-gradient-primary text-primary-foreground shadow-primary"
          : "bg-muted text-muted-foreground"
      )}>
        {aiMode === 'local' ? (
          <>
            <Brain className="w-3 h-3" />
            IA Local (Ollama)
          </>
        ) : (
          <>
            <Zap className="w-3 h-3" />
            Modo Básico
          </>
        )}
      </div>
    );
  };

  const getProgressBarColor = () => {
    switch (state) {
      case 'success':
        return 'bg-gradient-success';
      case 'error':
        return 'bg-destructive';
      default:
        return 'bg-gradient-primary';
    }
  };

  return (
    <div className={cn(
      "bg-card border rounded-xl p-6 shadow-lg backdrop-blur-sm animate-fade-in-up",
      state === 'success' && "border-success/20 shadow-success",
      state === 'error' && "border-destructive/20",
      className
    )}>
      <div className="space-y-4">
        {/* Header with icon and AI mode */}
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            {getStateIcon()}
            <div className="flex-1">
              <h3 className="text-lg font-semibold text-foreground">
                {statusMessage}
              </h3>
              {subMessage && (
                <p className="text-sm text-muted-foreground mt-1">
                  {subMessage}
                </p>
              )}
            </div>
          </div>
          {getAiModeIndicator()}
        </div>

        {/* Progress Bar */}
        <div className="relative">
          <div className="w-full bg-muted rounded-full h-3 overflow-hidden">
            {state === 'indeterminate' ? (
              <div className={cn(
                "h-full w-1/3 rounded-full animate-progress-flow",
                getProgressBarColor()
              )} />
            ) : (
              <div
                className={cn(
                  "h-full rounded-full transition-all duration-500 ease-out",
                  getProgressBarColor()
                )}
                style={{ width: `${Math.max(displayProgress, 2)}%` }}
              />
            )}
          </div>

          {/* Progress percentage */}
          {state === 'determinate' && (
            <div className="absolute -top-6 right-0 text-xs text-muted-foreground font-medium">
              {Math.round(displayProgress)}%
            </div>
          )}
        </div>

        {/* Time estimation and actions */}
        <div className="flex items-center justify-between">
          <div className="text-sm text-muted-foreground">
            {estimatedTimeRemaining && estimatedTimeRemaining > 0 && (
              <span>Tiempo estimado: {formatTime(estimatedTimeRemaining)}</span>
            )}
            {state === 'success' && (
              <span className="text-success font-medium">¡Completado exitosamente!</span>
            )}
            {state === 'error' && (
              <span className="text-destructive font-medium">Error en el procesamiento</span>
            )}
          </div>

          <div className="flex items-center gap-2">
            {state === 'error' && onRetry && (
              <Button
                variant="outline"
                size="sm"
                onClick={onRetry}
                className="hover:bg-primary hover:text-primary-foreground"
              >
                Reintentar
              </Button>
            )}

            {showCancelButton && onCancel && (state === 'indeterminate' || state === 'determinate') && (
              <Button
                variant="ghost"
                size="sm"
                onClick={onCancel}
                className="hover:bg-destructive hover:text-destructive-foreground"
              >
                <X className="w-4 h-4 mr-1" />
                Cancelar
              </Button>
            )}
          </div>
        </div>

        {/* Success glow effect */}
        {state === 'success' && (
          <div className="absolute inset-0 rounded-xl bg-gradient-success opacity-5 animate-pulse-glow pointer-events-none" />
        )}
      </div>
    </div>
  );
};
import React, { useState, useEffect } from 'react';
import { Card } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Progress } from '@/components/ui/progress';
import { Badge } from '@/components/ui/badge';
import { User, Calendar, CheckCircle2, AlertCircle, Clock } from 'lucide-react';
import { cn } from '@/lib/utils';

export enum Gender {
  MALE = 'male',
  FEMALE = 'female',
  OTHER = 'other'
}

export interface ClientData {
  selectedGender: Gender | null;
  clientAge: number | null;
  trainingDays: number;
}

export interface ClientInfoCardProps {
  data: ClientData;
  onChange: (data: ClientData) => void;
  className?: string;
}

const GENDER_OPTIONS = [
  { value: Gender.MALE, label: 'Hombre', icon: '👨' },
  { value: Gender.FEMALE, label: 'Mujer', icon: '👩' },
  { value: Gender.OTHER, label: 'Otro', icon: '👤' }
];

const TRAINING_DAYS_OPTIONS = [
  { value: 1, label: '1 día', description: 'Principiante' },
  { value: 2, label: '2 días', description: 'Básico' },
  { value: 3, label: '3 días', description: 'Intermedio' },
  { value: 4, label: '4 días', description: 'Avanzado' },
  { value: 5, label: '5 días', description: 'Intensivo' },
  { value: 6, label: '6 días', description: 'Atlético' },
  { value: 7, label: '7 días', description: 'Profesional' }
];

export const ClientInfoCard: React.FC<ClientInfoCardProps> = ({
  data,
  onChange,
  className
}) => {
  const [ageInput, setAgeInput] = useState<string>(data.clientAge?.toString() || '');
  const [ageError, setAgeError] = useState<string>('');

  // Validation and completion calculation
  const validateAge = (age: number | null): boolean => {
    if (age === null) return false;
    return age >= 16 && age <= 100;
  };

  const isGenderValid = data.selectedGender !== null;
  const isAgeValid = validateAge(data.clientAge);
  const isTrainingDaysValid = data.trainingDays >= 1 && data.trainingDays <= 7;

  const completedFields = [isGenderValid, isAgeValid, isTrainingDaysValid].filter(Boolean).length;
  const completionPercentage = (completedFields / 3) * 100;
  const isValid = completedFields === 3;

  // Handle age input changes
  useEffect(() => {
    const ageValue = parseInt(ageInput);

    if (ageInput === '') {
      setAgeError('');
      onChange({ ...data, clientAge: null });
      return;
    }

    if (isNaN(ageValue)) {
      setAgeError('Por favor ingresa un número válido');
      return;
    }

    if (ageValue < 16) {
      setAgeError('La edad mínima es 16 años');
      return;
    }

    if (ageValue > 100) {
      setAgeError('La edad máxima es 100 años');
      return;
    }

    setAgeError('');
    onChange({ ...data, clientAge: ageValue });
  }, [ageInput]);

  const getCompletionStatus = () => {
    if (completionPercentage === 100) {
      return { color: 'text-success', bgColor: 'bg-success/10', icon: CheckCircle2, text: 'Completo' };
    } else if (completionPercentage > 0) {
      return { color: 'text-warning', bgColor: 'bg-warning/10', icon: Clock, text: 'En progreso' };
    } else {
      return { color: 'text-muted-foreground', bgColor: 'bg-muted', icon: AlertCircle, text: 'Pendiente' };
    }
  };

  const status = getCompletionStatus();
  const StatusIcon = status.icon;

  return (
    <Card className={cn(
      "relative overflow-hidden bg-card/50 backdrop-blur-sm border-2",
      isValid ? "border-success/30 shadow-success" : "border-border",
      className
    )}>
      {/* Completion glow effect */}
      {isValid && (
        <div className="absolute inset-0 bg-gradient-success opacity-5 animate-pulse-glow pointer-events-none" />
      )}

      <div className="p-6 space-y-6">
        {/* Header */}
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="p-2 bg-gradient-primary rounded-lg">
              <User className="w-5 h-5 text-primary-foreground" />
            </div>
            <div>
              <h3 className="text-xl font-semibold text-foreground">
                Datos del Cliente
              </h3>
              <p className="text-sm text-muted-foreground">
                Información básica para personalizar la rutina
              </p>
            </div>
          </div>

          <Badge
            variant="outline"
            className={cn(
              "flex items-center gap-2 px-3 py-1",
              status.color,
              status.bgColor
            )}
          >
            <StatusIcon className="w-4 h-4" />
            {status.text}
          </Badge>
        </div>

        {/* Progress Bar */}
        <div className="space-y-2">
          <div className="flex justify-between items-center">
            <Label className="text-sm text-muted-foreground">Progreso de completación</Label>
            <span className="text-sm font-medium text-foreground">{Math.round(completionPercentage)}%</span>
          </div>
          <Progress
            value={completionPercentage}
            className="h-2"
            style={{
              background: 'hsl(var(--muted))',
            }}
          />
        </div>

        {/* Gender Selection */}
        <div className="space-y-3">
          <Label className="text-base font-medium flex items-center gap-2">
            <span className="text-2xl">👥</span>
            Género
            {!isGenderValid && <span className="text-destructive text-sm">(Requerido)</span>}
          </Label>

          <div className="grid grid-cols-1 sm:grid-cols-3 gap-3">
            {GENDER_OPTIONS.map((option) => (
              <Button
                key={option.value}
                variant={data.selectedGender === option.value ? "default" : "outline"}
                size="lg"
                className={cn(
                  "h-14 justify-start gap-3 text-base",
                  data.selectedGender === option.value
                    ? "bg-gradient-primary text-primary-foreground shadow-primary"
                    : "hover:bg-accent hover:text-accent-foreground"
                )}
                onClick={() => onChange({ ...data, selectedGender: option.value })}
              >
                <span className="text-xl">{option.icon}</span>
                {option.label}
              </Button>
            ))}
          </div>
        </div>

        {/* Age Input */}
        <div className="space-y-3">
          <Label className="text-base font-medium flex items-center gap-2">
            <span className="text-2xl">🎂</span>
            Edad del Cliente
            {!isAgeValid && data.clientAge !== null && <span className="text-destructive text-sm">(16-100 años)</span>}
          </Label>

          <div className="space-y-2">
            <Input
              type="number"
              placeholder="Ejemplo: 35"
              value={ageInput}
              onChange={(e) => setAgeInput(e.target.value)}
              className={cn(
                "h-12 text-base",
                ageError ? "border-destructive focus-visible:ring-destructive" : "",
                isAgeValid ? "border-success focus-visible:ring-success" : ""
              )}
              min="16"
              max="100"
            />
            {ageError && (
              <p className="text-sm text-destructive flex items-center gap-2">
                <AlertCircle className="w-4 h-4" />
                {ageError}
              </p>
            )}
          </div>
        </div>

        {/* Training Days Selection */}
        <div className="space-y-4">
          <Label className="text-base font-medium flex items-center gap-2">
            <Calendar className="w-5 h-5" />
            Días de Entrenamiento por Semana
          </Label>

          <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
            {TRAINING_DAYS_OPTIONS.map((option) => (
              <Button
                key={option.value}
                variant={data.trainingDays === option.value ? "default" : "outline"}
                size="lg"
                className={cn(
                  "h-16 flex-col gap-1 text-center",
                  data.trainingDays === option.value
                    ? "bg-gradient-secondary text-secondary-foreground shadow-primary"
                    : "hover:bg-accent hover:text-accent-foreground"
                )}
                onClick={() => onChange({ ...data, trainingDays: option.value })}
              >
                <span className="font-semibold">{option.label}</span>
                <span className="text-xs opacity-80">{option.description}</span>
              </Button>
            ))}
          </div>
        </div>

        {/* Summary */}
        {isValid && (
          <div className="p-4 bg-success/10 border border-success/20 rounded-lg animate-fade-in-up">
            <div className="flex items-center gap-2 mb-2">
              <CheckCircle2 className="w-5 h-5 text-success" />
              <h4 className="font-semibold text-success">Información Completa</h4>
            </div>
            <p className="text-sm text-muted-foreground">
              Cliente {data.selectedGender === Gender.MALE ? 'masculino' : data.selectedGender === Gender.FEMALE ? 'femenino' : ''}
              de {data.clientAge} años, entrenando {data.trainingDays} {data.trainingDays === 1 ? 'día' : 'días'} por semana.
            </p>
          </div>
        )}
      </div>
    </Card>
  );
};
